---
title: "WA State Parks Challenge - Interactive Map"
output: 
  html_document:
    includes:
      after_body: footer.html
editor_options: 
  chunk_output_type: console
---

```{r, echo = FALSE, message = FALSE, warning=FALSE, comment = FALSE}

  ## Set libraries
  library(sf)
  library(tmap)

  # Load Data
  data_df <- readRDS(file.path(getwd(), 'data', 'created', paste0('data.RDS')))
  visited_sf <- readRDS(file.path(getwd(), 'data', 'created', paste0('visited.RDS')))
  points_sf <- readRDS(file.path(getwd(), 'data', 'created', paste0('points.RDS')))
  routes_sf <- readRDS(file.path(getwd(), 'data', 'created', paste0('routes.RDS')))
  boundaries_sf <- readRDS(file.path(getwd(), 'data', 'created', paste0('boundaries.RDS')))
  
  
  points_sf <- 
   points_sf %>% dplyr::mutate(Visited = ifelse(Visited == 1, 
                                                paste0('Been There: ', nrow(visited_sf)),
                                                paste0('Not Yet: ', nrow(data_df) - nrow(visited_sf))))

  routes_sf <- routes_sf %>%
    dplyr::mutate(type = ifelse(type == 'drive', 'automobile', type),
                  `Travel Mode` = type)
  
```

&nbsp;
&nbsp;

```{r, echo = FALSE, cache = FALSE, comment = FALSE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7}


  
  Boundaries <- boundaries_sf %>%
    dplyr::filter(Abbrv %in% visited_sf$Abbrv)

  tmap_mode("view")
  

  tm_shape(Boundaries) + 
    tm_polygons(col = 'darkgreen', alpha = .8) +
    #tm_text("Abbrv", size = .8, ymod = .1, col = 'gray60') +
  
  tm_shape(routes_sf, alpha = .8) + 
    tm_lines(col="Travel Mode", scale=2, legend.lwd.show = FALSE, 
             palette = c('gray70', 'darkslategray3', 'deepskyblue4', 'brown', 'red')) +
    
  tm_shape(points_sf, alpha = .8) + 
    tm_dots(col='Visited', palette = c('forestgreen', 'black')) 
    

```